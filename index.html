<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="resources/favicon_16x16.png" sizes="16x16" type="image/png">
    <link rel="icon" href="resources/favicon_32x32.png" sizes="32x32" type="image/png">
    <link rel="icon" href="resources/favicon_48x48.png" sizes="48x48" type="image/png">
    <link rel="icon" href="resources/favicon_192x192.png" sizes="192x192" type="image/png">
    <link rel="preload" href="resources/gameroom.gif" as="image">
    <title>Vicioware</title>
    <style>
        @font-face {
            font-family: 'Manrope'; /* Nombre que le damos a la fuente para usarla luego */
            src: url('fonts/Manrope-SemiBold.ttf') format('truetype'); /* Ruta al archivo de la fuente y su formato. Asegúrate que el archivo existe. */
            font-weight: 400; /* 'Regular' suele corresponder a un peso de 400. Si es 'Light', usa 300 y el archivo correcto. */
            font-style: normal;
        }

        body {
            font-family: 'Manrope', sans-serif; /* Usamos Manrope, con sans-serif como fallback */
            margin: 0;
            background-color: #1c1c1c; /* Nuevo color de fondo */
            color: #f0f0f0; /* Color de texto general claro para contraste */
        }
        #searchBar {
            display: block; /* Para poder aplicar márgenes automáticos y centrar */
            padding: 8px 15px;
            border-radius: 20px;
            border: 1px solid #555;
            background-color: #2a2a2a;
            color: #f0f0f0;
            font-size: 0.9em;
            width: 400px; /* Ancho aumentado */
            max-width: 90%; /* Para asegurar que no se desborde en pantallas pequeñas */
            font-family: 'Manrope', sans-serif;
            outline: none;
            margin: 25px auto 20px; /* Centra la barra, margen superior 23px, inferior 20px */
        }
        .gallery-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center; /* Alinea los items al centro */
            padding: 10px; /* Margen leve alrededor del contenedor */
            gap: 10px; /* Espacio leve entre los elementos */
        }
        .game-item {
            position: relative; /* Necesario para el posicionamiento absoluto del pseudo-elemento ::after */
            background: linear-gradient(to bottom, #1a1a1a, #111111 40%, #0a0a0a); /* Estilo metálico mate oscuro */
            border-radius: 8px;
            text-align: center;
            width: 120px; /* Ancho reducido en un 40% */
            overflow: visible; /* Permitir que el resplandor del pseudo-elemento se muestre fuera */
            text-decoration: none; /* Quita el subrayado del enlace */
            transition: transform 0.2s ease-in-out; /* Mantenemos la transición de hover */
            z-index: 1; /* Asegurar que la tarjeta esté por encima de otros elementos si es necesario */
        }
        .game-item::before, .game-item::after { /* Estilos comunes para ambos pseudo-elementos de resplandor */
            content: '';
            position: absolute;
            opacity: 0;
        }
        .game-item::after { /* Pseudo-elemento para el efecto de resplandor de colores (lava lamp) */
            z-index: -2; /* Detrás del resplandor blanco y del contenido de .game-item */
            inset: -6px; /* Ligeramente más grande que la tarjeta para el efecto glow */
            /* Ahora un solo color, el predominante de la imagen, con un fallback */
            background: var(--dominant-glow-color, rgba(200, 200, 200, 0.2)); /* Fallback: gris claro semitransparente */
            /* Ya no se necesita animación ni background-size para un solo color */
            filter: blur(12px); /* Desenfoque para el efecto de resplandor */
            border-radius: 14px; /* (radio original de la tarjeta + valor de inset) */
            transition: opacity 0.4s ease-in-out;
        }
        .game-item::before { /* Pseudo-elemento para el resplandor blanco de contorno */
            z-index: -1; /* Encima del resplandor de colores, detrás del contenido de .game-item */
            inset: 0; /* Coincide con el tamaño de la tarjeta */
            border-radius: 8px; /* Mismo borde que la tarjeta */
            /* Sombra blanca para el contorno, menos intensa que el resplandor de colores */
            box-shadow: 0 0 7px 2px rgba(255, 255, 255, 0.35); 
            transition: opacity 0.3s ease-in-out;
        }
        .game-item:hover {
            transform: scale(1.05); /* Efecto de zoom al pasar el ratón */
        }
        .game-item:hover::after {
            opacity: 0.7; /* Mostrar el resplandor en hover, ajusta la opacidad según prefieras */
        }
        .game-item:hover::before {
            opacity: 1; /* Mostrar el resplandor blanco. La intensidad se controla con la opacidad de la box-shadow */
        }
        .game-item img {
            width: 100%; /* La imagen ocupa todo el ancho del contenedor */
            height: auto; /* Mantiene la proporción de la imagen */
            display: block; /* Ayuda a evitar espacios extra y asegura que el border-radius se aplique bien */
            border-top-left-radius: 8px; /* Redondear esquinas superiores de la imagen */
            border-top-right-radius: 8px;
            /* Estilos para carga progresiva */
            opacity: 0; /* Inicialmente oculta */
            transition: opacity 0.4s ease-in-out; /* Transición suave para la aparición */
            background-color: #2a2a2a; /* Color de fondo placeholder, similar al de la searchBar */
            /* Ajusta este valor a una altura promedio/mínima esperada de tus portadas para evitar saltos de layout */
            min-height: 160px; 
        }
        .game-item p {
            margin: 10px 0; /* Margen para el nombre del juego */
            font-size: 0.9em;
            color: #fff; /* Texto blanco */
            text-shadow: 0 0 4px rgba(255, 255, 255, 0.4); /* Resplandor suave para legibilidad */
            padding: 0 5px; /* Espacio para que el texto no toque los bordes */
        }
    </style>
    <style>
        /* Modal Styles */
        .modal {
            display: flex; /* Usamos flex para centrar el contenido */
            align-items: center; /* Centrado vertical */
            justify-content: center; /* Centrado horizontal */
            position: fixed; /* Stay in place */
            z-index: 100; /* Sit on top */
            left: 0;
            top: 0;
            width: 100%; /* Full width */
            height: 100%; /* Full height */
            background-color: rgba(0,0,0,0.7); /* Black w/ opacity */
            /* Propiedades para la animación de apertura/cierre */
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease-in-out, visibility 0s linear 0.3s; /* visibility cambia después de que la opacidad se desvanece */
        }

        .modal.is-open {
            opacity: 1;
            visibility: visible;
            transition-delay: 0s; /* Asegura que la visibilidad sea inmediata al abrir */
        }

        .modal-content {
            background-color: #1c1c1c;
            padding: 25px;
            border: 1px solid #444; /* Borde ligeramente oscurecido */
            width: 90%; 
            max-width: 550px; 
            border-radius: 10px;
            position: relative;
            color: #f0f0f0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.5);
            transform: translateY(-30px) scale(0.95);
            opacity: 0;
            transition: transform 0.3s ease-in-out, opacity 0.3s ease-in-out;
        }

        .close-button {
            color: #aaa;
            float: right;
            font-size: 30px;
            font-weight: bold;
            line-height: 1;
        }

        .close-button:hover,
        .close-button:focus {
            color: #fff;
            text-decoration: none;
            cursor: pointer;
        }

        .modal.is-open .modal-content {
            transform: translateY(0) scale(1);
            opacity: 1;
        }

        #modalGameTitle {
            text-align: center;
            margin-top: 0;
            margin-bottom: 20px;
            font-size: 1.8em;
            border-bottom: 1px solid #444;
            padding-bottom: 0.5em;
        }

        #modalDownloadLinks {
            list-style: none;
            padding: 0;
        }

        #modalDownloadLinks li {
            margin-bottom: -35px; 
        }

        #modalDownloadLinks a {
            display: block; /* Make links take full width */
            background-color: #5ac560; /* Nuevo color base del botón */
            color: white;
            padding: 12px 18px;
            text-decoration: none;
            border-radius: 6px;
            transition: background-color 0.2s ease-in-out, transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            text-align: center;
            font-size: 1em;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.4); /* Sombra negra suave para el texto */
        }

        #modalDownloadLinks a:hover {
            background-color: #5ac560;
            transform: translateY(0px) scale(1.02); /* Efecto de elevación y agrandamiento suave */
            box-shadow: 0 0 10px 2px rgba(110, 255, 102, 0.644); /* Glow suave del color #2fc427 */
        }

        /* Estilos para "Leer más" */
        .read-more-container {
            margin-top: 10px; /* Espacio entre el botón y el "Leer más" */
            /* text-align: left; es el default para div, así que el span se alineará a la izquierda */
        }

        .read-more-toggle {
            color: #a0a0a0; /* Un gris claro */
            font-size: 0.85em;
            text-decoration: underline;
            cursor: pointer;
            display: inline-block; /* Para que no ocupe todo el ancho y se alinee a la izquierda */
            padding: 3px 0; /* Pequeño padding vertical */
        }

        .read-more-toggle:hover {
            color: #fff; /* Más brillante al pasar el ratón */
        }

        .read-more-content {
            margin-top: 8px;
            padding: 0 10px; /* Padding horizontal, vertical controlado por max-height/transición */
            background-color: #252525; /* Un poco diferente al fondo del modal */
            border-radius: 4px;
            font-size: 0.9em;
            color: #e0e0e0;
            border: 1px solid #333;
            max-height: 0;
            overflow: hidden;
            white-space: pre-line; /* Para respetar los saltos de línea (\n) en el texto */
            opacity: 0;
            transition: max-height 0.35s ease-out, opacity 0.35s ease-out, padding-top 0.35s ease-out, padding-bottom 0.35s ease-out;
        }

        .read-more-content.visible {
            max-height: 300px; /* Ajustar según el contenido máximo esperado. Puede ser un valor grande como 100vh. */
            opacity: 1;
            padding-top: 10px;
            padding-bottom: 10px;
        }
    </style>
    <style>
        body.modal-blur-active > .gallery-container { /* Solo afecta al gallery-container */
            filter: blur(5px);
            transition: filter 0.3s ease-in-out;
        }
        .gallery-container { /* Para asegurar un des-desenfoque suave */
            transition: filter 0.3s ease-in-out;
        }

        /* Estilos para la Notificación de "Pasar el rato" */
        .hangout-notification {
            position: fixed;
            top: 20px;
            right: -400px; /* Inicialmente fuera de la pantalla */
            width: 300px;
            background-color: #2f2f2f;
            color: #f0f0f0;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            z-index: 1001; /* Encima del modal si es necesario, o ajustar */
            transition: right 0.5s ease-in-out;
            font-size: 0.9em;
        }

        .hangout-notification.show {
            right: 20px; /* Deslizar hacia adentro */
        }

        .hangout-notification p {
            margin-top: 0;
            margin-bottom: 10px;
        }

        .hangout-notification .close-notif-btn {
            float: right;
            cursor: pointer;
            font-weight: bold;
            margin-left: 10px; /* Espacio si hay otros botones */
            font-size: 1.2em;
            line-height: 1;
        }

        /* Estilos para el ícono de Gameroom */
        .gameroom-icon-link {
            position: absolute; /* Cambiado de fixed a absolute */
            top: 15px; /* Movido 5px hacia arriba (25px - 5px) */
            right: 17px; /* Movido 10px hacia la derecha (30px - 10px) */
            z-index: 1000; /* Debajo de la notificación (hangout-notification es 1001) */
            display: block;
        }

        .gameroom-icon-link img {
            width: 78px; /* Ancho base aumentado en 10px adicionales (68 + 10) */
            height: 58.5px; /* Alto calculado para mantener proporción 4:3 (78 * 3/4) */
            transition: transform 0.3s ease-in-out; /* Transición solo para transform */
        }

        .gameroom-icon-link:hover img {
            transform: scale(1.15); /* Solo agranda al pasar el ratón, el desplazamiento ya está en la base */
            /* Se eliminó filter y rotate */
        }
    </style>
    <style>
        /* Estilos para el ícono de Vicioware */
        .vicioware-icon-link {
            position: absolute; /* Cambiado de fixed a absolute */
            top: 15px;
            left: 32px; /* Espaciado desde la izquierda */
            z-index: 1002; /* Mismo z-index que el ícono de gameroom para consistencia */
            display: block;
        }
        .vicioware-icon-link img {
            width: 48px; /* Tamaño ajustado para el ícono */
            height: 48px; /* Tamaño ajustado para el ícono */
            transition: transform 0.3s ease-in-out, filter 0.3s ease-in-out;
        }
        .vicioware-icon-link:hover img {
            transform: scale(1.15); /* Efecto de agrandamiento sutil al pasar el ratón */
            filter: drop-shadow(0 0 8px rgba(255, 255, 255, 0.5)); /* Resplandor blanco sutil */
        }
    </style>
</head>
<body>
    <a href="index.html" class="vicioware-icon-link">
        <img src="resources/vicioware_icon.png">
    </a>
    <a href="gameroom.html" class="gameroom-icon-link">
        <img src="resources/gameroom.png">
    </a>
    <input type="search" id="searchBar" placeholder="Buscar juegos...">

    <div class="gallery-container">
        <a href="#" data-game-id="halo-ce" class="game-item">
            <img src="portadas/halo-ce.png" loading="lazy">
            <p>Halo: Combat Evolved</p>
        </a>

        <a href="#" data-game-id="gta-sa" class="game-item">
            <img src="portadas/gta-sa.png" loading="lazy">
            <p>Grand Theft Auto: San Andreas</p>
        </a>

        <a href="#" data-game-id="gta-vc" class="game-item">
            <img src="portadas/gta-vc.png" loading="lazy">
            <p>Grand Theft Auto: Vice City</p>
        </a>

        <a href="#" data-game-id="gta3" class="game-item">
            <img src="portadas/gta3.png" loading="lazy">
            <p>Grand Theft Auto III</p>
        </a>

        <a href="#" data-game-id="cuphead" class="game-item">
            <img src="portadas/cuphead.png" loading="lazy">
            <p>Cuphead</p>
        </a>

        <a href="#" data-game-id="unmetal" class="game-item">
            <img src="portadas/unmetal.png" loading="lazy">
            <p>Unmetal</p>
        </a>

        <a href="#" data-game-id="portal" class="game-item">
            <img src="portadas/portal.png" loading="lazy">
            <p>Portal</p>
        </a>

        <a href="#" data-game-id="portal2" class="game-item">
            <img src="portadas/portal2.png" loading="lazy">
            <p>Portal 2</p>
        </a>

        <a href="#" data-game-id="REPO" class="game-item">
            <img src="portadas/REPO.png" loading="lazy">
            <p>R.E.P.O</p>
        </a>

        <a href="#" data-game-id="dbfz" class="game-item">
            <img src="portadas/dbfz.png" loading="lazy">
            <p>Dragon Ball FighterZ</p>
        </a>

        <a href="#" data-game-id="brotato" class="game-item">
            <img src="portadas/brotato.png" loading="lazy">
            <p>Brotato</p>
        </a>

        <a href="#" data-game-id="assassinscreed" class="game-item">
            <img src="portadas/assassinscreed.png" loading="lazy">
            <p>Assassin's Creed</p>
        </a>

        <a href="#" data-game-id="tomb-raider" class="game-item">
            <img src="portadas/tomb-raider.png" loading="lazy">
            <p>Tomb Raider (2013)</p>
        </a>

        <a href="#" data-game-id="vampire-survivors" class="game-item">
            <img src="portadas/vampire-survivors.png" loading="lazy">
            <p>Vampire Survivors</p>
        </a>

        <a href="#" data-game-id="horizon-chase-turbo" class="game-item">
            <img src="portadas/horizon-chase-turbo.png" loading="lazy">
            <p>Horizon Chase Turbo</p>
        </a>

        <a href="#" data-game-id="barony" class="game-item">
            <img src="portadas/barony.png" loading="lazy">
            <p>Barony</p>
        </a>

        <a href="#" data-game-id="dmc-devil-may-cry" class="game-item">
            <img src="portadas/dmc-devil-may-cry.png" loading="lazy">
            <p>DmC: Devil May Cry</p>
        </a>

        <a href="#" data-game-id="call-of-duty" class="game-item">
            <img src="portadas/call-of-duty.png" loading="lazy">
            <p>Call of Duty</p>
        </a>

        <a href="#" data-game-id="age-of-empires" class="game-item">
            <img src="portadas/age-of-empires.png" loading="lazy">
            <p>Age of Empires</p>
        </a>

        <a href="#" data-game-id="a-way-out" class="game-item">
            <img src="portadas/a-way-out.png" loading="lazy">
            <p>A Way Out</p>
        </a>

        <a href="#" data-game-id="dead-space" class="game-item">
            <img src="portadas/dead-space.png" loading="lazy">
            <p>Dead Space</p>
        </a>

        <a href="#" data-game-id="dead-space2" class="game-item">
            <img src="portadas/dead-space2.png" loading="lazy">
            <p>Dead Space 2</p>
        </a>

        <a href="#" data-game-id="dead-space3" class="game-item">
            <img src="portadas/dead-space3.png" loading="lazy">
            <p>Dead Space 3</p>
        </a>

        <a href="#" data-game-id="life-is-strange" class="game-item">
            <img src="portadas/life-is-strange.png" loading="lazy">
            <p>Life is Strange</p>
        </a>

        <a href="#" data-game-id="life-is-strange-before-the-storm" class="game-item">
            <img src="portadas/life-is-strange-before-the-storm.png" loading="lazy">
            <p>Life is Strange: Before the Storm</p>
        </a>

        <a href="#" data-game-id="slendytubbies" class="game-item">
            <img src="portadas/slendytubbies.png" loading="lazy">
            <p>Slendytubbies</p>
        </a>

        <a href="#" data-game-id="slendytubbies2" class="game-item">
            <img src="portadas/slendytubbies2.png" loading="lazy">
            <p>Slendytubbies II</p>
        </a>

        <a href="#" data-game-id="slendytubbies3" class="game-item">
            <img src="portadas/slendytubbies3.png" loading="lazy">
            <p>Slendytubbies III</p>
        </a>

        <a href="#" data-game-id="blur" class="game-item">
            <img src="portadas/blur.png" loading="lazy">
            <p>Blur</p>
        </a>

        <a href="#" data-game-id="colin-mcrae-rally" class="game-item">
            <img src="portadas/colin-mcrae-rally.png" loading="lazy">
            <p>Colin McRae Rally</p>
        </a>

        <a href="#" data-game-id="conan" class="game-item">
            <img src="portadas/conan.png" loading="lazy">
            <p>Conan</p>
        </a>

        <a href="#" data-game-id="counter-strike" class="game-item">
            <img src="portadas/counter-strike.png" loading="lazy">
            <p>Counter Strike 1.6</p>
        </a>

        <a href="#" data-game-id="flatout" class="game-item">
            <img src="portadas/flatout.png" loading="lazy">
            <p>FlatOut</p>
        </a>

        <a href="#" data-game-id="flatout2" class="game-item">
            <img src="portadas/flatout2.png" loading="lazy">
            <p>FlatOut 2</p>
        </a>

        <a href="#" data-game-id="sifu" class="game-item">
            <img src="portadas/sifu.png" loading="lazy">
            <p>Sifu</p>
        </a>

        <a href="#" data-game-id="resident-evil4" class="game-item">
            <img src="portadas/resident-evil4.png" loading="lazy">
            <p>Resident Evil 4</p>
        </a>

        <a href="#" data-game-id="alan-wake" class="game-item">
            <img src="portadas/alan-wake.png" loading="lazy">
            <p>Alan Wake</p>
        </a>

        <a href="#" data-game-id="amid-evil" class="game-item">
            <img src="portadas/amid-evil.png" loading="lazy">
            <p>Amid Evil</p>
        </a>

        <a href="#" data-game-id="assassinscreed2" class="game-item">
            <img src="portadas/assassinscreed2.png" loading="lazy">
            <p>Assassin's Creed II</p>
        </a>

        <a href="#" data-game-id="assassinscreed-brotherhood" class="game-item">
            <img src="portadas/assassinscreed-brotherhood.png" loading="lazy">
            <p>Assassin's Creed: Brotherhood</p>
        </a>

        <a href="#" data-game-id="assassinscreed-revelations" class="game-item">
            <img src="portadas/assassinscreed-revelations.png" loading="lazy">
            <p>Assassin's Creed: Revelations</p>
        </a>

        <a href="#" data-game-id="assassinscreed3" class="game-item">
            <img src="portadas/assassinscreed3.png" loading="lazy">
            <p>Assassin's Creed III</p>
        </a>

        <a href="#" data-game-id="assassinscreed-liberation" class="game-item">
            <img src="portadas/assassinscreed-liberation.png" loading="lazy">
            <p>Assassin's Creed: Liberation</p>
        </a>

        <a href="#" data-game-id="assassinscreed4" class="game-item">
            <img src="portadas/assassinscreed4.png" loading="lazy">
            <p>Assassin's Creed IV: Black Flag</p>
        </a>

        <a href="#" data-game-id="assassinscreed-freedomcry" class="game-item">
            <img src="portadas/assassinscreed-freedomcry.png" loading="lazy">
            <p>Assassin's Creed: Freedom Cry</p>
        </a>

        <a href="#" data-game-id="assassinscreed-rogue" class="game-item">
            <img src="portadas/assassinscreed-rogue.png" loading="lazy">
            <p>Assassin's Creed Rogue</p>
        </a>

        <a href="#" data-game-id="assassinscreed-chronicles-china" class="game-item">
            <img src="portadas/assassinscreed-chronicles-china.png" loading="lazy">
            <p>Assassin's Creed Chronicles: China</p>
        </a>

        <a href="#" data-game-id="assassinscreed-chronicles-russia" class="game-item">
            <img src="portadas/assassinscreed-chronicles-russia.png" loading="lazy">
            <p>Assassin's Creed Chronicles: Russia</p>
        </a>

        <a href="#" data-game-id="assassinscreed-chronicles-india" class="game-item">
            <img src="portadas/assassinscreed-chronicles-india.png" loading="lazy">
            <p>Assassin's Creed Chronicles: India</p>
        </a>

        <a href="#" data-game-id="assassinscreed-unity" class="game-item">
            <img src="portadas/assassinscreed-unity.jpg" loading="lazy">
            <p>Assassin's Creed Unity</p>
        </a>

        <a href="#" data-game-id="assassinscreed-syndicate" class="game-item">
            <img src="portadas/assassinscreed-syndicate.png" loading="lazy">
            <p>Assassin's Creed Syndicate</p>
        </a>

        <a href="#" data-game-id="assassinscreed-origins" class="game-item">
            <img src="portadas/assassinscreed-origins.png" loading="lazy">
            <p>Assassin's Creed Origins</p>
        </a>

        <a href="#" data-game-id="assassinscreed-odyssey" class="game-item">
            <img src="portadas/assassinscreed-odyssey.png" loading="lazy">
            <p>Assassin's Creed Odyssey</p>
        </a>

        <a href="#" data-game-id="assassinscreed-valhalla" class="game-item">
            <img src="portadas/assassinscreed-valhalla.png" loading="lazy">
            <p>Assassin's Creed Valhalla</p>
        </a>

        <a href="#" data-game-id="assassinscreed-mirage" class="game-item">
            <img src="portadas/assassinscreed-mirage.png" loading="lazy">
            <p>Assassin's Creed Mirage</p>
        </a>

        <a href="#" data-game-id="assassinscreed-shadows" class="game-item">
            <img src="portadas/assassinscreed-shadows.png" loading="lazy">
            <p>Assassin's Creed Shadows</p>
        </a>

        <a href="#" data-game-id="bejeweled3" class="game-item">
            <img src="portadas/bejeweled3.png" loading="lazy">
            <p>Bejeweled 3</p>
        </a>

        <a href="#" data-game-id="bendy-ink" class="game-item">
            <img src="portadas/bendy-ink.png" loading="lazy">
            <p>Bendy and the Ink Machine</p>
        </a>

        <a href="#" data-game-id="blasphemous" class="game-item">
            <img src="portadas/blasphemous.png" loading="lazy">
            <p>Blasphemous 3</p>
        </a>

        <a href="#" data-game-id="borderlands" class="game-item">
            <img src="portadas/borderlands.png" loading="lazy">
            <p>Borderlands</p>
        </a>

        <a href="#" data-game-id="borderlands2" class="game-item">
            <img src="portadas/borderlands2.jpg" loading="lazy">
            <p>Borderlands 2</p>
        </a>

        <a href="#" data-game-id="detroit-become-human" class="game-item">
            <img src="portadas/detroit-become-human.png" loading="lazy">
            <p>Detroit: Become Human</p>
        </a>

        <a href="#" data-game-id="far-cry" class="game-item">
            <img src="portadas/far-cry.png" loading="lazy">
            <p>Far Cry</p>
        </a>

        <a href="#" data-game-id="far-cry2" class="game-item">
            <img src="portadas/far-cry2.png" loading="lazy">
            <p>Far Cry 2</p>
        </a>

        <a href="#" data-game-id="far-cry3" class="game-item">
            <img src="portadas/far-cry3.png" loading="lazy">
            <p>Far Cry 3</p>
        </a>

        <a href="#" data-game-id="far-cry4" class="game-item">
            <img src="portadas/far-cry4.png" loading="lazy">
            <p>Far Cry 4</p>
        </a>

        <a href="#" data-game-id="far-cry5" class="game-item">
            <img src="portadas/far-cry5.png" loading="lazy">
            <p>Far Cry 5</p>
        </a>

        <a href="#" data-game-id="far-cry-new-dawn" class="game-item">
            <img src="portadas/far-cry-new-dawn.png" loading="lazy">
            <p>Far Cry New Dawn</p>
        </a>

        <a href="#" data-game-id="far-cry-primal" class="game-item">
            <img src="portadas/far-cry-primal.png" loading="lazy">
            <p>Far Cry Primal</p>
        </a>

        <a href="#" data-game-id="fnaf" class="game-item">
            <img src="portadas/fnaf.png" loading="lazy">
            <p>Five Nights at Freddy's</p>
        </a>

        <a href="#" data-game-id="fnaf2" class="game-item">
            <img src="portadas/fnaf2.png" loading="lazy">
            <p>Five Nights at Freddy's 2</p>
        </a>

        <a href="#" data-game-id="fnaf3" class="game-item">
            <img src="portadas/fnaf3.png" loading="lazy">
            <p>Five Nights at Freddy's 3</p>
        </a>

        <a href="#" data-game-id="fnaf4" class="game-item">
            <img src="portadas/fnaf4.png" loading="lazy">
            <p>Five Nights at Freddy's 4</p>
        </a>

        <a href="#" data-game-id="fnaf5" class="game-item">
            <img src="portadas/fnaf5.png" loading="lazy">
            <p>FNAF: Sister Location</p>
        </a>

        <a href="#" data-game-id="friday-night-funkin" class="game-item">
            <img src="portadas/friday-night-funkin.png" loading="lazy">
            <p>Friday Night Funkin</p>
        </a>

        <a href="#" data-game-id="garrys-mod" class="game-item">
            <img src="portadas/garrys-mod.png" loading="lazy">
            <p>Garry's Mod</p>
        </a>

        <a href="#" data-game-id="guts-and-glory" class="game-item">
            <img src="portadas/guts-and-glory.png" loading="lazy">
            <p>Guts and Glory</p>
        </a>

        <a href="#" data-game-id="human-fall-flat" class="game-item">
            <img src="portadas/human-fall-flat.png" loading="lazy">
            <p>Human Fall Flat</p>
        </a>

        <a href="#" data-game-id="mafia2" class="game-item">
            <img src="portadas/mafia2.png" loading="lazy">
            <p>Mafia II</p>
        </a>

        <a href="#" data-game-id="resident-evil5" class="game-item">
            <img src="portadas/resident-evil5.png" loading="lazy">
            <p>Resident Evil 5</p>
        </a>

        <a href="#" data-game-id="resident-evil6" class="game-item">
            <img src="portadas/resident-evil6.png" loading="lazy">
            <p>Resident Evil 6</p>
        </a>

        <a href="#" data-game-id="stray" class="game-item">
            <img src="portadas/stray.png" loading="lazy">
            <p>Stray</p>
        </a>

        <a href="#" data-game-id="valiant-hearts" class="game-item">
            <img src="portadas/valiant-hearts.png" loading="lazy">
            <p>Valiant Hearts</p>
        </a>

        <a href="#" data-game-id="watch-dogs" class="game-item">
            <img src="portadas/watch-dogs.png" loading="lazy">
            <p>Watch Dogs</p>
        </a>

        <a href="#" data-game-id="watch-dogs2" class="game-item">
            <img src="portadas/watch-dogs2.png" loading="lazy">
            <p>Watch Dogs 2</p>
        </a>

        <a href="#" data-game-id="watch-dogs-legion" class="game-item">
            <img src="portadas/watch-dogs-legion.png" loading="lazy">
            <p>Watch Dogs: Legion</p>
        </a>
    </div>

    <!-- Modal Structure -->
    <div id="downloadModal" class="modal">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <h2 id="modalGameTitle">Nombre del Juego</h2>
            <ul id="modalDownloadLinks">
                <!-- Download links will be populated here by JavaScript -->
            </ul>
        </div>
    </div>

    <!-- Notificación de "Pasar el rato" -->
    <div id="hangoutNotification" class="hangout-notification">
        <span class="close-notif-btn" onclick="closeHangoutNotification()">&times;</span>
        <p>¿Te gustaría pasar el rato mientras esperas tu descarga?</p>
        <div style="text-align: right;">
            <button onclick="redirectToMinigames()" style="padding: 8px 12px; background-color: #5ac560; color: white; border: none; border-radius: 4px; cursor: pointer;">De acuerdo</button>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/color-thief/2.4.0/color-thief.umd.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const gameItems = document.querySelectorAll('.game-item');
            const colorThief = new ColorThief();

            // Modal elements
            const modal = document.getElementById('downloadModal');
            const modalGameTitle = document.getElementById('modalGameTitle');
            const modalDownloadLinksList = document.getElementById('modalDownloadLinks');
            const closeButton = modal.querySelector('.close-button');
            // const galleryContainer = document.querySelector('.gallery-container'); // No longer needed for icon alignment
            const searchBar = document.getElementById('searchBar'); // searchBar ya está aquí
            const hangoutNotification = document.getElementById('hangoutNotification');
            let hangoutTimer = null; // Para controlar el temporizador de la notificación
            let notificationAutoCloseTimer = null; // Para controlar el autocierre de la notificación

            // Data for download links
            const gameDownloadLinksData = {
                'gta-sa': [ { text: 'Descargar GTA: San Andreas', url: 'https://example.com/gta-sa-link' } ],
                'cuphead': [
                    { text: 'Descargar Cuphead (Principal)', url: 'https://example.com/cuphead-main' },
                    { text: 'Descargar Cuphead (Alternativo)', url: 'https://example.com/cuphead-alt' }
                ],
                'unmetal': [{ text: 'Descargar Unmetal', url: 'https://example.com/unmetal-download' }],
                'portal': [{ text: 'Descargar Portal', url: 'https://example.com/portal-download' }],
                'portal2': [{ text: 'Descargar Portal 2', url: 'https://example.com/portal2-download' }],
                'REPO': [{ text: 'Descargar R.E.P.O', url: 'https://example.com/repo-download' }],
                'dbfz': [{ text: 'Descargar Dragon Ball FighterZ', url: 'https://example.com/dbfz-download' }],
                'brotato': [{ text: 'Descargar Brotato', url: 'https://example.com/brotato-download' }],
                'assassinscreed': [{ text: 'Descargar Assassin\'s Creed', url: 'https://example.com/assassinscreed-download' }],
                'tomb-raider': [{ text: 'Descargar Tomb Raider (2013)', url: 'https://example.com/tomb-raider-download' }],
                'vampire-survivors': [{ text: 'Descargar Vampire Survivors', url: 'https://example.com/vampire-survivors-download' }],
                'horizon-chase-turbo': [{ text: 'Descargar Horizon Chase Turbo', url: 'https://example.com/horizon-chase-turbo-download' }],
                'barony': [{ text: 'Descargar Barony', url: 'https://example.com/barony-download' }],
                'dmc-devil-may-cry': [{ text: 'Descargar DmC: Devil May Cry', url: 'https://example.com/dmc-devil-may-cry-download' }],
                'call-of-duty': [{ text: 'Descargar Call of Duty', url: 'https://example.com/call-of-duty-download' }],
                'halo-ce': [{
                    text: 'Descargar',
                    url: 'https://www.mediafire.com/file/jftpybq93hfqy26/HCE_2001.rar/file',
                    readMoreText: '- Versión 1.0.10\n- Español\n- Multijugador funcional'
                }]
            };

            // const gameroomIconLink = document.querySelector('.gameroom-icon-link'); // No longer needed

            function updateImageLoadingPriority() {
                const visibleGameItems = [];
                // gameItems está disponible en este scope (definido en DOMContentLoaded)
                gameItems.forEach(item => {
                    // Usamos getComputedStyle para obtener el estado de display real
                    const style = window.getComputedStyle(item);
                    if (style.display !== 'none') {
                        visibleGameItems.push(item);
                    }
                });

                // Paso 1: Asegurar que todas las imágenes tengan loading="lazy" por defecto.
                // Esto resetea el estado para los items que podrían dejar de ser prioritarios.
                gameItems.forEach(item => {
                    const img = item.querySelector('img');
                    if (img && img.getAttribute('loading') !== 'lazy') {
                        img.setAttribute('loading', 'lazy');
                    }
                });

                // Paso 2: Quitar loading="lazy" de las primeras 30 imágenes visibles.
                const limit = 30;
                for (let i = 0; i < visibleGameItems.length && i < limit; i++) {
                    const item = visibleGameItems[i];
                    const img = item.querySelector('img');
                    if (img) {
                        img.removeAttribute('loading');
                    }
                }
            }

            function openModal(gameId, gameName) {
                modalGameTitle.textContent = gameName; // Actualiza el título del modal
                modalDownloadLinksList.innerHTML = ''; // Limpia enlaces anteriores

                if (gameId && gameDownloadLinksData[gameId]) {
                    const links = gameDownloadLinksData[gameId];
                    links.forEach((linkInfo, index) => { // <--- Añadido 'index' aquí
                        
                        const listItem = document.createElement('li');
                        const isLastItemInList = (index === links.length - 1);
                        const anchor = document.createElement('a');
                        anchor.href = linkInfo.url;
                        anchor.textContent = linkInfo.text;
                        anchor.target = '_blank'; // Abrir en nueva pestaña

                        // Event listener para el clic en el botón de descarga
                        anchor.addEventListener('click', () => {
                            // Comprobar si la notificación ya se mostró en esta sesión
                            if (!sessionStorage.getItem('hangoutNotificationShown')) {
                                // Limpiar cualquier temporizador anterior si el usuario hace clic rápidamente en varios enlaces
                                if (hangoutTimer) clearTimeout(hangoutTimer);
                                // Ocultar notificación si ya está visible (por si acaso, aunque no debería si se muestra solo una vez)
                                hangoutNotification.classList.remove('show');

                                hangoutTimer = setTimeout(showHangoutNotification, 10000); // 10 segundos
                                // Marcar que la notificación está programada para mostrarse (o ya se mostró) en esta sesión
                            }
                        });

                        listItem.appendChild(anchor);
                        modalDownloadLinksList.appendChild(listItem);

                        // Añadir "Leer más" si existe texto
                        if (linkInfo.readMoreText) {
                            const readMoreContainer = document.createElement('div');
                            readMoreContainer.className = 'read-more-container';

                            const readMoreToggle = document.createElement('span');
                            readMoreToggle.className = 'read-more-toggle';
                            readMoreToggle.textContent = 'Detalles';

                            const readMoreContent = document.createElement('div');
                            readMoreContent.className = 'read-more-content';
                            readMoreContent.textContent = linkInfo.readMoreText;

                            // Guardar el listItem padre para fácil acceso
                            const parentListItem = listItem;

                            readMoreToggle.addEventListener('click', function() {
                                const isVisible = readMoreContent.classList.toggle('visible');
                                this.textContent = isVisible ? 'Ocultar detalles' : 'Detalles';

                                // Solo ajustar el margen si es el último item de la lista.
                                // Si no es el último, el margen ya está fijado en 10px para el espaciado entre botones.
                                if (isLastItemInList) {
                                    parentListItem.style.marginBottom = isVisible ? '-10px' : '-35px';
                                }
                            });

                            readMoreContainer.appendChild(readMoreToggle);
                            readMoreContainer.appendChild(readMoreContent);
                            listItem.appendChild(readMoreContainer); // Añadir al final del listItem

                            // Establecer margen inicial para este li
                            if (isLastItemInList) {
                                listItem.style.marginBottom = '-35px'; // Es el último y tiene "Detalles" (ocultos por defecto)
                            } else {
                                listItem.style.marginBottom = '10px'; // No es el último, necesita 10px de espacio debajo
                            }
                        } else { // No hay "Detalles"
                            if (isLastItemInList) {
                                listItem.style.marginBottom = '-15px'; // Es el último y no tiene "Detalles"
                            } else {
                                listItem.style.marginBottom = '10px'; // No es el último, necesita 10px de espacio debajo
                            }
                        }
                    });
                } else {
                    const listItem = document.createElement('li');
                    listItem.textContent = 'No hay enlaces de descarga disponibles para este juego.';
                    modalDownloadLinksList.appendChild(listItem);
                    console.warn('No se encontraron enlaces de descarga para el juego:', gameId);
                }
                document.body.classList.add('modal-blur-active'); // Aplicar desenfoque al fondo
                modal.classList.add('is-open'); // Mostrar y animar modal
            }

            // Llamada inicial para establecer la prioridad de carga al cargar la página
            updateImageLoadingPriority();

            function closeModal() {
                document.body.classList.remove('modal-blur-active'); // Quitar desenfoque
                modal.classList.remove('is-open'); // Ocultar y animar modal de descarga
                // No cerramos la notificación de "pasar el rato" aquí, se maneja por separado
            }

            // Event listener para el botón de cierre del modal
            closeButton.addEventListener('click', closeModal);

            // Event listener para cerrar el modal haciendo clic fuera de su contenido
            window.addEventListener('click', (event) => {
                if (event.target === modal) {
                    closeModal();
                }
            });

            // Event listener para cerrar el modal con la tecla Escape
            window.addEventListener('keydown', (event) => {
                // Pequeña mejora: comprobar la clase en lugar del estilo display directamente
                if (event.key === 'Escape' && modal.classList.contains('is-open')) {
                    closeModal();
                }
            });

            // Función para limpiar cadenas para la búsqueda (ignorar mayúsculas/minúsculas y caracteres especiales)
            function sanitizeSearchTerm(term) {
                return term.toLowerCase().replace(/[^a-z0-9]/g, '');
            }

            // Event listener para la barra de búsqueda
            searchBar.addEventListener('input', (event) => {
                const rawSearchTerm = event.target.value.trim();
                const sanitizedSearchTerm = sanitizeSearchTerm(rawSearchTerm);

                gameItems.forEach(item => {
                    const rawGameTitle = item.querySelector('p').textContent;
                    const sanitizedGameTitle = sanitizeSearchTerm(rawGameTitle);
                    if (sanitizedGameTitle.includes(sanitizedSearchTerm)) {
                        item.style.display = ''; // Muestra el item si coincide
                    } else {
                        item.style.display = 'none'; // Oculta el item si no coincide
                    }
                });
                // Actualizar la prioridad de carga después de filtrar
                updateImageLoadingPriority();
                // alignGameroomIcon(); // Ya no se necesita
            });

            gameItems.forEach(item => {
                const img = item.querySelector('img');
                const originalSrc = img.getAttribute('src'); // Guardar src original desde el atributo
                const hoverSrc = item.dataset.hoverSrc; // Ruta de la imagen para el hover
                let hoverTimer = null; // Temporizador para el hover
                let isHoverImageDisplayed = false; // Bandera para saber si la imagen de hover está activa

                let dynamicGlowColors = null; // Para almacenar los colores extraídos para este item

                // Renombrada y modificada para incluir el cambio de opacidad y la lógica de ColorThief
                function processLoadedImage() {
                    // Hacemos la imagen visible
                    img.style.opacity = '1';
                    // Opcional: si se usó min-height en CSS y se quiere que la imagen tome su altura natural exacta al cargar.
                    // Descomentar la siguiente línea si se prefiere este comportamiento.
                    // img.style.minHeight = 'auto';

                    // Lógica de ColorThief (asegurarse de que la imagen esté realmente cargada y sea válida)
                    if (img.complete && img.naturalWidth > 0 && img.naturalHeight > 0) {
                        try {
                            const dominantColorArray = colorThief.getColor(img); 
                            
                            if (dominantColorArray) {
                                dynamicGlowColors = {};
                                const rgbString = `rgb(${dominantColorArray[0]}, ${dominantColorArray[1]}, ${dominantColorArray[2]})`;
                                dynamicGlowColors['--dominant-glow-color'] = rgbString;
                                // Si el cursor ya está sobre el elemento cuando la imagen carga, aplicar el glow
                                if (item.matches(':hover')) {
                                    item.style.setProperty('--dominant-glow-color', rgbString);
                                }
                            } else {
                                console.warn('ColorThief: No se pudo extraer una paleta para:', img.src);
                                dynamicGlowColors = null;
                            }
                        } catch (error) {
                            console.error('ColorThief error para la imagen:', img.src, error);
                            dynamicGlowColors = null;
                        }
                    } else if (!img.complete) {
                    } else {
                        console.warn('ColorThief: Imagen cargada pero inválida (sin dimensiones):', img.src);
                        dynamicGlowColors = null;
                    }
                }

                // Intentar extraer colores si la imagen ya está cargada
                // (importante para imágenes cacheadas o ya visibles)
                if (img.complete && img.naturalWidth > 0) {
                    processLoadedImage();
                }
                // Siempre añadir el listener 'load' para imágenes que cargan después (incluyendo lazy-loaded)
                img.addEventListener('load', processLoadedImage);

                img.addEventListener('error', () => {
                    console.error('Error al cargar la imagen:', img.src);
                    img.style.opacity = '1'; // Hacer visible para mostrar el alt text o el fondo de error
                    dynamicGlowColors = null;
                });

                item.addEventListener('mouseenter', () => {
                    if (dynamicGlowColors && dynamicGlowColors['--dominant-glow-color']) {
                        item.style.setProperty('--dominant-glow-color', dynamicGlowColors['--dominant-glow-color']);
                    }

                    // Lógica para cambiar imagen en hover prolongado
                    if (hoverSrc) {
                        if (hoverTimer) clearTimeout(hoverTimer); // Limpiar temporizador anterior si existe
                        hoverTimer = setTimeout(() => {
                            // Verificar si el cursor sigue sobre el elemento
                            if (item.matches(':hover')) {
                                img.style.opacity = '0'; // Inicia el desvanecimiento de la imagen actual
                                setTimeout(() => {
                                    // Re-verificar si el cursor sigue sobre el elemento,
                                    // ya que el usuario pudo haberse movido durante el desvanecimiento.
                                    if (item.matches(':hover')) {
                                        img.src = hoverSrc; // Cambia la fuente; el evento 'load' se encargará del fade-in
                                        isHoverImageDisplayed = true;
                                    } else {
                                        // Si el cursor ya no está, la imagen original (que se estaba desvaneciendo) vuelve a ser opaca.
                                        img.style.opacity = '1';
                                    }
                                }, 400); // Espera a que termine la transición de opacidad (0.4s CSS)
                            }
                        }, 1000); // 1000 ms = 1 segundo
                    }
                });

                item.addEventListener('mouseleave', () => {
                    // Limpiar el temporizador si el cursor se retira antes de que se complete
                    if (hoverTimer) {
                        clearTimeout(hoverTimer);
                        hoverTimer = null;
                    }

                    // Restaurar la imagen original si se mostró la de hover
                    if (isHoverImageDisplayed) {
                        img.style.opacity = '0'; // Inicia el desvanecimiento de la imagen de hover
                        setTimeout(() => {
                            img.src = originalSrc; // Cambia la fuente; el evento 'load' se encargará del fade-in
                            isHoverImageDisplayed = false;
                        }, 400); // Espera a que termine la transición de opacidad
                    }

                    // Lógica existente para quitar el resplandor
                    setTimeout(() => {
                        if (dynamicGlowColors && !item.matches(':hover')) {
                            item.style.removeProperty('--dominant-glow-color');
                        }
                    }, 400); // Coincide con la duración de la transición de opacidad de ::after
                });

                // Event listener para abrir el modal al hacer clic en la tarjeta
                item.addEventListener('click', (event) => {
                    event.preventDefault(); // Previene la acción por defecto del enlace (navegar a #)
                    
                    const gameId = item.dataset.gameId;
                    const gameName = item.querySelector('p').textContent;

                    if (gameId) {
                        openModal(gameId, gameName);
                    } else {
                        console.error('Atributo data-game-id no encontrado en el item:', item);
                    }
                });
            });

            // Funciones para la notificación de "Pasar el rato"
            function showHangoutNotification() {
                // Si ya hay un temporizador de autocierre, limpiarlo (por si se llama a show múltiples veces rápidamente)
                if (notificationAutoCloseTimer) clearTimeout(notificationAutoCloseTimer);

                hangoutNotification.classList.add('show');
                // Marcar que la notificación se ha mostrado en esta sesión
                sessionStorage.setItem('hangoutNotificationShown', 'true');

                // Iniciar temporizador para ocultar automáticamente después de 10 segundos
                notificationAutoCloseTimer = setTimeout(() => {
                    closeHangoutNotification(); // Reutilizar la función de cierre
                }, 10000); // 10 segundos para ocultar
            }

            // Estas funciones se declaran globalmente para ser accesibles desde el onclick en el HTML
            window.closeHangoutNotification = function() {
                hangoutNotification.classList.remove('show');
                if (hangoutTimer) clearTimeout(hangoutTimer); // Detener el temporizador si se cierra manualmente
                if (notificationAutoCloseTimer) clearTimeout(notificationAutoCloseTimer); // Detener el temporizador de autocierre
            }
            
            window.redirectToMinigames = function() {
                // Cambia 'minijuegos.html' por la URL real de tu sección de minijuegos
                window.open('gameroom.html', '_blank'); 
                closeHangoutNotification(); // Cierra la notificación después de redirigir
            }

            // window.addEventListener('load', alignGameroomIcon); // Ya no se necesita
            // window.addEventListener('resize', alignGameroomIcon); // Ya no se necesita

            // Funcionalidad para cambiar el icono de Gameroom a GIF en hover
            const gameroomIconLink = document.querySelector('.gameroom-icon-link');
            if (gameroomIconLink) {
                const gameroomIconImage = gameroomIconLink.querySelector('img');
                if (gameroomIconImage) {
                    const originalGameroomSrc = gameroomIconImage.src; // Captura la ruta del PNG actual
                    const hoverGameroomSrc = 'resources/gameroom.gif'; // Ruta al GIF

                    gameroomIconLink.addEventListener('mouseenter', () => {
                        gameroomIconImage.src = hoverGameroomSrc;
                    });

                    gameroomIconLink.addEventListener('mouseleave', () => {
                        gameroomIconImage.src = originalGameroomSrc;
                    });
                }
            }

        });
    </script>
</body>
</html>
